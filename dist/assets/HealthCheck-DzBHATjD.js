import{r as e,j as t,w as s,h as r,t as a,C as i}from"./react-vendor-CYm809Et.js";import"./vendor-DC1Pnyyi.js";import"./chart-vendor-hJRC9QiP.js";const n=new class{metrics=[];maxMetrics=1e3;record(e,t,s="ms",r){const a={name:e,value:t,unit:s,timestamp:Date.now(),metadata:r};this.metrics.push(a),this.metrics.length>this.maxMetrics&&this.metrics.shift()}async measure(e,t){const s=performance.now();try{const r=await t(),a=performance.now()-s;return this.record(e,a,"ms",{success:!0}),r}catch(r){const t=performance.now()-s;throw this.record(e,t,"ms",{success:!1,error:String(r)}),r}}getMetrics(e){return e?this.metrics.filter(t=>t.name===e):[...this.metrics]}generateReport(){const e=this.metrics.filter(e=>"ms"===e.unit);if(0===e.length)return{metrics:[],summary:{avgResponseTime:0,maxResponseTime:0,minResponseTime:0,totalRequests:0,errorRate:0},bottlenecks:[],recommendations:[]};const t=e.map(e=>e.value),s=e.filter(e=>!1===e.metadata?.success).length,r=t.reduce((e,t)=>e+t,0)/t.length,a=Math.max(...t),i=Math.min(...t),n=s/e.length*100,o=e.filter(e=>e.value>1e3).map(e=>`${e.name}: ${e.value.toFixed(2)}ms`).filter((e,t,s)=>s.indexOf(e)===t),c=[];return r>500&&c.push("Average response time is high. Consider optimizing API calls or implementing caching."),n>5&&c.push(`Error rate is ${n.toFixed(2)}%. Investigate failing requests.`),o.length>0&&c.push(`${o.length} operations detected with >1s response time. Consider optimization.`),{metrics:this.metrics,summary:{avgResponseTime:r,maxResponseTime:a,minResponseTime:i,totalRequests:e.length,errorRate:n},bottlenecks:o,recommendations:c}}clear(){this.metrics=[]}recordWebVitals(){if("undefined"==typeof window||!window.performance)return;const e=performance.getEntriesByType("navigation")[0];e&&(this.record("page_load",e.loadEventEnd-e.fetchStart,"ms"),this.record("dns_lookup",e.domainLookupEnd-e.domainLookupStart,"ms"),this.record("tcp_connection",e.connectEnd-e.connectStart,"ms"),this.record("dom_content_loaded",e.domContentLoadedEventEnd-e.fetchStart,"ms"));const t=performance.getEntriesByType("resource").reduce((e,t)=>e+(t.transferSize||0),0);this.record("total_resource_size",t,"bytes");performance.getEntriesByType("paint").forEach(e=>{this.record(e.name,e.startTime,"ms")})}};const o=new class{errors=[];maxErrors=100;handlers=[];track(e,t="medium",s){const r={id:this.generateId(),message:e instanceof Error?e.message:e,stack:e instanceof Error?e.stack:void 0,severity:t,timestamp:Date.now(),context:s,userAgent:"undefined"!=typeof navigator?navigator.userAgent:void 0,url:"undefined"!=typeof window?window.location.href:void 0};this.errors.push(r),this.errors.length>this.maxErrors&&this.errors.shift(),this.handlers.forEach(e=>e(r))}trackCritical(e,t){this.track(e,"critical",t)}trackHigh(e,t){this.track(e,"high",t)}trackMedium(e,t){this.track(e,"medium",t)}trackLow(e,t){this.track(e,"low",t)}onError(e){return this.handlers.push(e),()=>{const t=this.handlers.indexOf(e);t>-1&&this.handlers.splice(t,1)}}getErrors(e){return e?this.errors.filter(t=>t.severity===e):[...this.errors]}getStats(){const e=this.errors.length,t=this.errors.filter(e=>"critical"===e.severity).length,s=this.errors.filter(e=>"high"===e.severity).length;return{total:e,critical:t,high:s,medium:this.errors.filter(e=>"medium"===e.severity).length,low:this.errors.filter(e=>"low"===e.severity).length,criticalRate:t/e*100||0,highRate:s/e*100||0}}clear(){this.errors=[]}generateId(){return`err_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}initGlobalHandlers(){if("undefined"==typeof window)return;window.addEventListener("error",e=>{this.track(e.error||e.message,"high",{type:"unhandled_error",filename:e.filename,lineno:e.lineno,colno:e.colno})}),window.addEventListener("unhandledrejection",e=>{this.track(e.reason instanceof Error?e.reason:String(e.reason),"high",{type:"unhandled_rejection"})});const e=console.error;console.error=(...t)=>{const s=t.join(" ");s.includes("React")&&this.track(s,"medium",{type:"react_error",args:t}),e.apply(console,t)}}};"undefined"!=typeof window&&o.initGlobalHandlers();const c=()=>{const[c,d]=e.useState({status:"healthy",timestamp:Date.now(),services:{api:"healthy",database:"healthy",queue:"healthy",websocket:"healthy"},metrics:{responseTime:0,errorRate:0,uptime:0}});e.useEffect(()=>{const e=async()=>{try{const e=await fetch("/health",{method:"GET"}).then(e=>e.ok?"healthy":"degraded").catch(()=>"down"),t=n.generateReport(),s=o.getStats(),r=performance.now()/1e3/60,a={api:e,database:"healthy",queue:"healthy",websocket:"healthy"},i=Object.values(a).includes("down")?"down":Object.values(a).includes("degraded")?"degraded":"healthy";d({status:i,timestamp:Date.now(),services:a,metrics:{responseTime:t.summary.avgResponseTime,errorRate:s.criticalRate+s.highRate,uptime:r}})}catch(e){d(e=>({...e,status:"down"}))}};e();const t=setInterval(e,3e4);return()=>clearInterval(t)},[]);const l=e=>{switch(e){case"healthy":return t.jsx(i,{className:"h-6 w-6 text-green-500"});case"degraded":return t.jsx(a,{className:"h-6 w-6 text-yellow-500"});case"down":return t.jsx(r,{className:"h-6 w-6 text-red-500"});default:return t.jsx(s,{className:"h-6 w-6 text-gray-500"})}};return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{children:[t.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"System Health"}),t.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Real-time monitoring of system components and performance"})]}),t.jsx("div",{className:"rounded-lg bg-white p-6 shadow",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center",children:[l(c.status),t.jsxs("div",{className:"ml-4",children:[t.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Overall Status"}),t.jsxs("p",{className:"text-sm text-gray-500",children:["Last updated: ",new Date(c.timestamp).toLocaleTimeString()]})]})]}),t.jsx("span",{className:`inline-flex rounded-full px-3 py-1 text-sm font-semibold ${(e=>{switch(e){case"healthy":return"bg-green-100 text-green-800";case"degraded":return"bg-yellow-100 text-yellow-800";case"down":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}})(c.status)}`,children:c.status.toUpperCase()})]})}),t.jsx("div",{className:"grid grid-cols-1 gap-6 sm:grid-cols-2 lg:grid-cols-4",children:Object.entries(c.services).map(([e,s])=>t.jsx("div",{className:"rounded-lg bg-white p-6 shadow",children:t.jsxs("div",{className:"flex items-center",children:[l(s),t.jsxs("div",{className:"ml-4",children:[t.jsx("p",{className:"text-sm font-medium text-gray-600 capitalize",children:e}),t.jsx("p",{className:"text-lg font-semibold "+("healthy"===s?"text-green-600":"degraded"===s?"text-yellow-600":"text-red-600"),children:s})]})]})},e))}),t.jsxs("div",{className:"rounded-lg bg-white shadow",children:[t.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:t.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Performance Metrics"})}),t.jsx("div",{className:"p-6",children:t.jsxs("dl",{className:"grid grid-cols-1 gap-6 sm:grid-cols-3",children:[t.jsxs("div",{children:[t.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"Avg Response Time"}),t.jsxs("dd",{className:"mt-1 text-3xl font-semibold text-gray-900",children:[c.metrics.responseTime.toFixed(0),"ms"]})]}),t.jsxs("div",{children:[t.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"Error Rate"}),t.jsxs("dd",{className:"mt-1 text-3xl font-semibold text-gray-900",children:[c.metrics.errorRate.toFixed(2),"%"]})]}),t.jsxs("div",{children:[t.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"Uptime"}),t.jsxs("dd",{className:"mt-1 text-3xl font-semibold text-gray-900",children:[c.metrics.uptime.toFixed(0),"m"]})]})]})})]})]})};export{c as default};
