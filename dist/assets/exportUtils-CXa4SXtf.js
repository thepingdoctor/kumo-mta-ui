import{r as e,j as t,D as a,a5 as o,a6 as i}from"./react-vendor-CYm809Et.js";import{P as n,E as r,k as s}from"./vendor-DC1Pnyyi.js";const l=({onExport:n,disabled:r=!1,formats:s=["pdf","csv"],label:l="Export",className:d="",showDropdown:c=!0})=>{const[u,g]=e.useState(!1),h=e=>{n(e),g(!1)};if(!c||1===s.length){const e=s[0];return t.jsxs("button",{onClick:()=>h(e),disabled:r,className:`inline-flex items-center px-4 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed ${d}`,"aria-label":`Export as ${e.toUpperCase()}`,children:[t.jsx(a,{className:"h-4 w-4 mr-2"}),l," ",1===s.length?e.toUpperCase():""]})}return t.jsxs("div",{className:"relative inline-block text-left",children:[t.jsxs("button",{onClick:()=>g(!u),disabled:r,className:`inline-flex items-center justify-center px-4 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed ${d}`,"aria-haspopup":"true","aria-expanded":u,children:[t.jsx(a,{className:"h-4 w-4 mr-2"}),l,t.jsx("svg",{className:"ml-2 -mr-1 h-5 w-5",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",children:t.jsx("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})})]}),u&&t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>g(!1),"aria-hidden":"true"}),t.jsx("div",{className:"origin-top-right absolute right-0 mt-2 w-48 rounded-md shadow-lg bg-white ring-1 ring-black ring-opacity-5 focus:outline-none z-20",role:"menu","aria-orientation":"vertical",children:t.jsxs("div",{className:"py-1",role:"none",children:[s.includes("pdf")&&t.jsxs("button",{onClick:()=>h("pdf"),className:"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 hover:text-gray-900 flex items-center",role:"menuitem",children:[t.jsx(o,{className:"h-4 w-4 mr-3 text-red-500"}),"Export as PDF"]}),s.includes("csv")&&t.jsxs("button",{onClick:()=>h("csv"),className:"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 hover:text-gray-900 flex items-center",role:"menuitem",children:[t.jsx(i,{className:"h-4 w-4 mr-3 text-green-500"}),"Export as CSV"]})]})})]})]})},d=(e,t,a=!0)=>{if(e.setFontSize(20),e.setTextColor(37,99,235),e.text("KumoMTA Dashboard",14,22),e.setFontSize(14),e.setTextColor(55,65,81),e.text(t,14,32),a){e.setFontSize(10),e.setTextColor(107,114,128);const t=(new Date).toLocaleString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"});e.text(`Generated: ${t}`,14,40)}return e.setDrawColor(229,231,235),e.setLineWidth(.5),e.line(14,45,e.internal.pageSize.width-14,45),50},c=(e,t,a)=>{e.setFontSize(10),e.setTextColor(75,85,99);let o=a;return Object.entries(t).forEach(([t,a])=>{e.setFont(void 0,"bold"),e.text(`${t}:`,14,o),e.setFont(void 0,"normal"),e.text(a,50,o),o+=6}),o+5},u=(e,t,a)=>{let o=e;a&&(o=e.map(e=>{const t={};return a.forEach(a=>{t[a.header]=e[a.dataKey]||""}),t}));const i=n.unparse(o,{quotes:!0,header:!0}),r=new Blob([i],{type:"text/csv;charset=utf-8;"}),s=document.createElement("a"),l=URL.createObjectURL(r);s.setAttribute("href",l),s.setAttribute("download",t),s.style.visibility="hidden",document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(l)},g=e=>{const t={"Total Items":e.length.toString(),Waiting:e.filter(e=>"waiting"===e.status).length.toString(),Processing:e.filter(e=>["sending","in-progress"].includes(e.status)).length.toString(),Completed:e.filter(e=>"completed"===e.status).length.toString()};((e,t,a,o={})=>{const{title:i="Data Export",orientation:n="portrait",includeDate:l=!0,includeMetadata:u=!1,metadata:g={}}=o,h=new r({orientation:n,unit:"mm",format:"a4"});let m=d(h,i,l);u&&Object.keys(g).length>0&&(m=c(h,g,m)),s(h,{startY:m,head:[a.map(e=>e.header)],body:e.map(e=>a.map(t=>e[t.dataKey]||"")),theme:"grid",styles:{fontSize:9,cellPadding:3,overflow:"linebreak"},headStyles:{fillColor:[37,99,235],textColor:255,fontStyle:"bold",halign:"left"},alternateRowStyles:{fillColor:[249,250,251]},margin:{left:14,right:14}});const f=h.getNumberOfPages();for(let r=1;r<=f;r++)h.setPage(r),h.setFontSize(8),h.setTextColor(156,163,175),h.text(`Page ${r} of ${f}`,h.internal.pageSize.width/2,h.internal.pageSize.height-10,{align:"center"});h.save(t)})(e,`queue-export-${Date.now()}.pdf`,[{header:"Customer",dataKey:"customerName"},{header:"Email",dataKey:"customerEmail"},{header:"Recipient",dataKey:"recipient"},{header:"Sender",dataKey:"sender"},{header:"Status",dataKey:"status"},{header:"Service",dataKey:"serviceType"},{header:"Created",dataKey:"createdAt"}],{title:"Queue Management Report",orientation:"landscape",includeDate:!0,includeMetadata:!0,metadata:t})},h=(e,t={})=>{const a=new r({orientation:"portrait",unit:"mm",format:"a4"});let o=d(a,"Analytics Report",!0);const i={"Success Rate":e.successRate?`${e.successRate.toFixed(2)}%`:"N/A","Total Bounces":((e.bounces?.hard_bounces||0)+(e.bounces?.soft_bounces||0)).toString(),"Queue Efficiency":e.queueEfficiency?`${e.queueEfficiency.toFixed(1)}%`:"N/A",Throughput:e.throughput?`${e.throughput}/min`:"N/A"};o=c(a,i,o),o+=5;const n=a.internal.pageSize.width-28;if(Object.entries(t).forEach(([e,t])=>{o+80+20>a.internal.pageSize.height-20&&(a.addPage(),o=20),a.setFontSize(12),a.setTextColor(55,65,81),a.text(e,14,o),o+=8,t&&(a.addImage(t,"PNG",14,o,n,80),o+=90)}),e.bounces?.classifications&&e.bounces.classifications.length>0){const t=(e.bounces.hard_bounces||0)+(e.bounces.soft_bounces||0);o+40>a.internal.pageSize.height-20&&(a.addPage(),o=20),a.setFontSize(12),a.setTextColor(55,65,81),a.text("Bounce Classifications",14,o),o+=8;const i=e.bounces.classifications.map(e=>({code:e.code,description:e.description,count:e.count,percentage:(e.count/t*100).toFixed(2)+"%"}));s(a,{startY:o,head:[["Code","Description","Count","Percentage"]],body:i.map(e=>[e.code,e.description,e.count,e.percentage]),theme:"grid",styles:{fontSize:9,cellPadding:3},headStyles:{fillColor:[37,99,235],textColor:255,fontStyle:"bold"},alternateRowStyles:{fillColor:[249,250,251]},margin:{left:14,right:14}})}const l=a.getNumberOfPages();for(let r=1;r<=l;r++)a.setPage(r),a.setFontSize(8),a.setTextColor(156,163,175),a.text(`Page ${r} of ${l}`,a.internal.pageSize.width/2,a.internal.pageSize.height-10,{align:"center"});a.save(`analytics-report-${Date.now()}.pdf`)},m=(e,t,a)=>{const o=new r({orientation:"portrait",unit:"mm",format:"a4"});let i=d(o,"Security Audit Report",!0);o.setFontSize(14),o.setTextColor(55,65,81),o.text("TLS/SSL Configuration",14,i),i+=8;const n={Status:e.enabled?"Enabled":"Disabled","Certificate Path":e.certificatePath||"Not configured","Private Key Path":e.privateKeyPath||"Not configured","Cipher Suites":e.cipherSuites||"Default"};i=c(o,n,i),i+=10,o.setFontSize(14),o.setTextColor(55,65,81),o.text("DKIM Configuration",14,i),i+=8;const l={Status:t.enabled?"Enabled":"Disabled",Domain:t.domain||"Not configured",Selector:t.selector||"Not configured","Private Key Path":t.privateKeyPath||"Not configured"};i=c(o,l,i),i+=10,a.length>0&&(o.setFontSize(14),o.setTextColor(55,65,81),o.text("IP Access Rules",14,i),i+=8,s(o,{startY:i,head:[["IP Address","Type","Description"]],body:a.map(e=>[e.ip,e.type.charAt(0).toUpperCase()+e.type.slice(1),e.description]),theme:"grid",styles:{fontSize:9,cellPadding:3},headStyles:{fillColor:[37,99,235],textColor:255,fontStyle:"bold"},alternateRowStyles:{fillColor:[249,250,251]},margin:{left:14,right:14}}));const u=o.getNumberOfPages();for(let r=1;r<=u;r++)o.setPage(r),o.setFontSize(8),o.setTextColor(156,163,175),o.text(`Page ${r} of ${u}`,o.internal.pageSize.width/2,o.internal.pageSize.height-10,{align:"center"});o.save(`security-audit-${Date.now()}.pdf`)};export{l as E,u as a,h as b,m as c,g as e};
