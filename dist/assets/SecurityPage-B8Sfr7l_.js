import{r as e,K as s,j as r,$ as t,m as l,a2 as a,t as i,C as d,a3 as o,a4 as c}from"./react-vendor-CYm809Et.js";import{E as n,c as u}from"./exportUtils-CXa4SXtf.js";import"./vendor-DC1Pnyyi.js";import"./chart-vendor-hJRC9QiP.js";const m=()=>{const[m,x]=e.useState("tls"),[b,f]=e.useState([{id:"1",ip:"192.168.1.100",type:"whitelist",description:"Office IP"},{id:"2",ip:"10.0.0.0/8",type:"blacklist",description:"Private network range"}]),h=s({defaultValues:{enabled:!0,certificatePath:"/etc/kumomta/certs/server.crt",privateKeyPath:"/etc/kumomta/certs/server.key",cipherSuites:"TLS_AES_128_GCM_SHA256:TLS_AES_256_GCM_SHA384"}}),p=s({defaultValues:{enabled:!0,domain:"example.com",selector:"default",privateKeyPath:"/etc/kumomta/dkim/private.key"}}),g=[{id:"tls",label:"TLS/SSL",icon:t},{id:"dkim",label:"DKIM/SPF",icon:l},{id:"ip",label:"IP Management",icon:a},{id:"rate",label:"Rate Limiting",icon:i}];return r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Security Settings"}),r.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Configure security settings for your KumoMTA server"})]}),r.jsx(n,{onExport:e=>{if("pdf"===e){const e=h.getValues(),s=p.getValues();u(e,s,b)}},formats:["pdf"],label:"Export Audit",showDropdown:!1})]}),r.jsx("div",{className:"border-b border-gray-200",children:r.jsx("nav",{className:"-mb-px flex space-x-8",children:g.map(e=>{const s=e.icon;return r.jsxs("button",{onClick:()=>x(e.id),className:`\n                  group inline-flex items-center py-4 px-1 border-b-2 font-medium text-sm\n                  ${m===e.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}\n                `,children:[r.jsx(s,{className:`\n                  -ml-0.5 mr-2 h-5 w-5\n                  ${m===e.id?"text-blue-500":"text-gray-400 group-hover:text-gray-500"}\n                `}),e.label]},e.id)})})}),"tls"===m&&r.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:r.jsxs("form",{onSubmit:h.handleSubmit(e=>{}),className:"space-y-6",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"TLS/SSL Configuration"}),r.jsx("p",{className:"text-sm text-gray-500",children:"Configure TLS encryption for secure email delivery"})]}),r.jsxs("label",{className:"flex items-center cursor-pointer",children:[r.jsx("input",{...h.register("enabled"),type:"checkbox",className:"sr-only peer"}),r.jsx("div",{className:"relative w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"}),r.jsx("span",{className:"ml-3 text-sm font-medium text-gray-900",children:"Enabled"})]})]}),r.jsxs("div",{className:"grid grid-cols-1 gap-6",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Certificate Path"}),r.jsx("input",{...h.register("certificatePath",{required:"Certificate path is required"}),type:"text",className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500",placeholder:"/etc/kumomta/certs/server.crt"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Private Key Path"}),r.jsx("input",{...h.register("privateKeyPath",{required:"Private key path is required"}),type:"text",className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500",placeholder:"/etc/kumomta/certs/server.key"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Cipher Suites"}),r.jsx("input",{...h.register("cipherSuites"),type:"text",className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500",placeholder:"TLS_AES_128_GCM_SHA256:TLS_AES_256_GCM_SHA384"}),r.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Colon-separated list of allowed cipher suites"})]})]}),r.jsx("div",{className:"flex justify-end",children:r.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2",children:"Save TLS Configuration"})})]})}),"dkim"===m&&r.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:r.jsxs("form",{onSubmit:p.handleSubmit(e=>{}),className:"space-y-6",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"DKIM Configuration"}),r.jsx("p",{className:"text-sm text-gray-500",children:"Configure DKIM signing for email authentication"})]}),r.jsxs("label",{className:"flex items-center cursor-pointer",children:[r.jsx("input",{...p.register("enabled"),type:"checkbox",className:"sr-only peer"}),r.jsx("div",{className:"relative w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"}),r.jsx("span",{className:"ml-3 text-sm font-medium text-gray-900",children:"Enabled"})]})]}),r.jsxs("div",{className:"grid grid-cols-1 gap-6",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Domain"}),r.jsx("input",{...p.register("domain",{required:"Domain is required"}),type:"text",className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500",placeholder:"example.com"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Selector"}),r.jsx("input",{...p.register("selector",{required:"Selector is required"}),type:"text",className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500",placeholder:"default"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Private Key Path"}),r.jsx("input",{...p.register("privateKeyPath",{required:"Private key path is required"}),type:"text",className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500",placeholder:"/etc/kumomta/dkim/private.key"})]})]}),r.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-md p-4",children:r.jsxs("div",{className:"flex",children:[r.jsx(d,{className:"h-5 w-5 text-blue-600 mt-0.5"}),r.jsxs("div",{className:"ml-3",children:[r.jsx("h4",{className:"text-sm font-medium text-blue-900",children:"DNS Record Required"}),r.jsx("p",{className:"mt-1 text-sm text-blue-700",children:"Add the following DNS TXT record to your domain:"}),r.jsx("code",{className:"mt-2 block text-xs bg-white p-2 rounded border border-blue-200",children:'default._domainkey.example.com TXT "v=DKIM1; k=rsa; p=YOUR_PUBLIC_KEY"'})]})]})}),r.jsx("div",{className:"flex justify-end",children:r.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2",children:"Save DKIM Configuration"})})]})}),"ip"===m&&r.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"IP Access Control"}),r.jsx("p",{className:"text-sm text-gray-500",children:"Manage whitelist and blacklist rules"})]}),r.jsxs("button",{onClick:()=>{const e={id:Date.now().toString(),ip:"",type:"whitelist",description:""};f([...b,e])},className:"inline-flex items-center px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:[r.jsx(o,{className:"h-4 w-4 mr-2"}),"Add Rule"]})]}),r.jsx("div",{className:"space-y-4",children:b.map(e=>r.jsxs("div",{className:"flex items-center space-x-4 p-4 border border-gray-200 rounded-lg",children:[r.jsx("input",{type:"text",value:e.ip,onChange:s=>{f(b.map(r=>r.id===e.id?{...r,ip:s.target.value}:r))},className:"flex-1 rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500",placeholder:"192.168.1.100 or 10.0.0.0/8"}),r.jsxs("select",{value:e.type,onChange:s=>{f(b.map(r=>r.id===e.id?{...r,type:s.target.value}:r))},className:"rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500",children:[r.jsx("option",{value:"whitelist",children:"Whitelist"}),r.jsx("option",{value:"blacklist",children:"Blacklist"})]}),r.jsx("input",{type:"text",value:e.description,onChange:s=>{f(b.map(r=>r.id===e.id?{...r,description:s.target.value}:r))},className:"flex-1 rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500",placeholder:"Description"}),r.jsx("button",{onClick:()=>{return s=e.id,void f(b.filter(e=>e.id!==s));var s},className:"p-2 text-red-600 hover:bg-red-50 rounded-md",children:r.jsx(c,{className:"h-5 w-5"})})]},e.id))}),r.jsx("div",{className:"flex justify-end",children:r.jsx("button",{className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2",children:"Save IP Rules"})})]})}),"rate"===m&&r.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{children:[r.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Rate Limiting"}),r.jsx("p",{className:"text-sm text-gray-500",children:"Configure rate limits for email sending"})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Max Messages Per Hour"}),r.jsx("input",{type:"number",defaultValue:"1000",className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Max Recipients Per Message"}),r.jsx("input",{type:"number",defaultValue:"100",className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Max Concurrent Connections"}),r.jsx("input",{type:"number",defaultValue:"50",className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Throttle Delay (ms)"}),r.jsx("input",{type:"number",defaultValue:"100",className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"})]})]}),r.jsx("div",{className:"flex justify-end",children:r.jsx("button",{className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2",children:"Save Rate Limits"})})]})})]})};export{m as default};
