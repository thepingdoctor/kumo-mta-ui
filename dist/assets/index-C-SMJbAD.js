const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Layout-intDW-7O.js","assets/react-vendor-CYm809Et.js","assets/vendor-DC1Pnyyi.js","assets/chart-vendor-hJRC9QiP.js","assets/authStore-D2_G-NGY.js","assets/utils-vendor-YtSAaKOK.js","assets/useToast-DgYTMLSM.js","assets/Dashboard-_4ngm2m9.js","assets/api-BZ6vNX7b.js","assets/http-vendor-CHM7ATol.js","assets/LoadingSkeleton-DA_UOSRD.js","assets/QueueManager-heHsPXC9.js","assets/exportUtils-CXa4SXtf.js","assets/ConfigEditor-9f1t8Dbo.js","assets/AdvancedAnalytics-C1R4HXlQ.js","assets/HealthCheck-DzBHATjD.js","assets/LoginPage-CRmo6RvY.js","assets/ProtectedRoute-Dc5APFTv.js","assets/SecurityPage-B8Sfr7l_.js"])))=>i.map(i=>d[i]);
import{r as e,j as t,W as s,A as a,a as r,D as n,X as i,b as l,R as o,Q as d,B as c,d as m,e as x,N as h,f as u}from"./react-vendor-CYm809Et.js";import{_ as p,f as g}from"./vendor-DC1Pnyyi.js";import"./chart-vendor-hJRC9QiP.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const s of e)if("childList"===s.type)for(const e of s.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();class f extends e.Component{state={hasError:!1,error:null};static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,t){}render(){return this.state.hasError?t.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center px-4",children:t.jsxs("div",{className:"max-w-lg w-full bg-white shadow-lg rounded-lg p-8",children:[t.jsx("h1",{className:"text-2xl font-bold text-red-600 mb-4",children:"Something went wrong"}),t.jsx("p",{className:"text-gray-600 mb-4",children:"The application encountered an error. Please try refreshing the page."}),t.jsx("button",{onClick:()=>window.location.reload(),className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 transition-colors",children:"Refresh Page"}),!1]})}):this.props.children}}const w=({showOnlineNotification:n=!0,position:i="top"})=>{const[l,o]=e.useState(navigator.onLine),[d,c]=e.useState(!1),[m,x]=e.useState(0);e.useEffect(()=>{const e=()=>{o(!0),n&&(c(!0),setTimeout(()=>c(!1),3e3)),"serviceWorker"in navigator&&"sync"in ServiceWorkerRegistration.prototype&&navigator.serviceWorker.ready.then(e=>e.sync.register("sync-queued-requests")).catch(e=>{})},t=()=>{o(!1),c(!1)},s=e=>{const t=e;x(t.detail?.count||0)};return window.addEventListener("online",e),window.addEventListener("offline",t),window.addEventListener("sw-pending-requests",s),()=>{window.removeEventListener("online",e),window.removeEventListener("offline",t),window.removeEventListener("sw-pending-requests",s)}},[n]);const h="top"===i?"top-16":"bottom-4";return l&&!d?null:t.jsxs(t.Fragment,{children:[!l&&t.jsx("div",{className:`fixed ${h} left-1/2 transform -translate-x-1/2 z-50 animate-slide-down`,role:"alert","aria-live":"assertive",children:t.jsxs("div",{className:"bg-yellow-500 text-white px-6 py-3 rounded-lg shadow-lg flex items-center space-x-3 max-w-md",children:[t.jsx(s,{className:"w-5 h-5 flex-shrink-0"}),t.jsxs("div",{className:"flex-1",children:[t.jsx("p",{className:"font-semibold",children:"You're offline"}),t.jsx("p",{className:"text-sm",children:"Some features may be limited. Data will sync when you reconnect."}),m>0&&t.jsxs("p",{className:"text-xs mt-1 flex items-center",children:[t.jsx(a,{className:"w-3 h-3 mr-1"}),m," pending ",1===m?"request":"requests"]})]})]})}),l&&d&&t.jsx("div",{className:`fixed ${h} left-1/2 transform -translate-x-1/2 z-50 animate-slide-down`,role:"status","aria-live":"polite",children:t.jsxs("div",{className:"bg-green-500 text-white px-6 py-3 rounded-lg shadow-lg flex items-center space-x-3",children:[t.jsx(r,{className:"w-5 h-5 flex-shrink-0"}),t.jsxs("div",{children:[t.jsx("p",{className:"font-semibold",children:"You're back online"}),m>0&&t.jsxs("p",{className:"text-sm",children:["Syncing ",m," pending ",1===m?"request":"requests","..."]})]})]})})]})},j=()=>{const[s,a]=e.useState(null),[r,l]=e.useState(!1);e.useEffect(()=>{const e=e=>{e.preventDefault(),a(e);const t=localStorage.getItem("pwa-install-dismissed"),s=t?parseInt(t,10):0,r=(Date.now()-s)/864e5;(!t||r>7)&&l(!0)};return window.addEventListener("beforeinstallprompt",e),window.matchMedia("(display-mode: standalone)").matches&&l(!1),()=>{window.removeEventListener("beforeinstallprompt",e)}},[]);const o=()=>{l(!1),localStorage.setItem("pwa-install-dismissed",Date.now().toString())};return r?t.jsx("div",{className:"fixed bottom-4 left-4 right-4 md:left-auto md:right-4 md:max-w-md z-50 animate-slide-up",children:t.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl border border-gray-200 dark:border-gray-700 p-4",children:t.jsxs("div",{className:"flex items-start justify-between",children:[t.jsxs("div",{className:"flex items-start space-x-3 flex-1",children:[t.jsx("div",{className:"bg-blue-100 dark:bg-blue-900 p-2 rounded-lg",children:t.jsx(n,{className:"w-6 h-6 text-blue-600 dark:text-blue-400"})}),t.jsxs("div",{className:"flex-1",children:[t.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white mb-1",children:"Install KumoMTA Dashboard"}),t.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-3",children:"Install the app for quick access and offline support"}),t.jsxs("div",{className:"flex space-x-2",children:[t.jsx("button",{onClick:async()=>{if(!s)return;await s.prompt();const{outcome:e}=await s.userChoice;"accepted"===e||localStorage.setItem("pwa-install-dismissed",Date.now().toString()),a(null),l(!1)},className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white text-sm font-medium rounded-lg transition-colors",children:"Install"}),t.jsx("button",{onClick:o,className:"px-4 py-2 bg-gray-100 hover:bg-gray-200 dark:bg-gray-700 dark:hover:bg-gray-600 text-gray-700 dark:text-gray-300 text-sm font-medium rounded-lg transition-colors",children:"Not now"})]})]})]}),t.jsx("button",{onClick:o,className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 transition-colors ml-2","aria-label":"Close",children:t.jsx(i,{className:"w-5 h-5"})})]})})}):null},v=()=>{const[s,a]=e.useState(!1),[r,n]=e.useState(!1);e.useEffect(()=>{const e=()=>{a(!0)};return window.addEventListener("pwa-update-available",e),()=>{window.removeEventListener("pwa-update-available",e)}},[]);return s?t.jsx("div",{className:"fixed top-4 left-1/2 transform -translate-x-1/2 z-50 animate-slide-down",children:t.jsxs("div",{className:"bg-blue-600 text-white rounded-lg shadow-xl p-4 flex items-center space-x-3 max-w-md",children:[t.jsx("div",{className:"bg-white/20 p-2 rounded-lg",children:t.jsx(l,{className:"w-5 h-5 "+(r?"animate-spin":"")})}),t.jsxs("div",{className:"flex-1",children:[t.jsx("p",{className:"font-semibold",children:"Update Available"}),t.jsx("p",{className:"text-sm text-blue-100",children:"A new version is ready. Refresh to update."})]}),t.jsxs("div",{className:"flex space-x-2",children:[t.jsx("button",{onClick:()=>{n(!0),"serviceWorker"in navigator&&navigator.serviceWorker.getRegistration().then(e=>{e?.waiting&&(e.waiting.postMessage({type:"SKIP_WAITING"}),navigator.serviceWorker.addEventListener("controllerchange",()=>{window.location.reload()}))})},disabled:r,className:"px-3 py-1.5 bg-white text-blue-600 text-sm font-medium rounded-lg hover:bg-blue-50 transition-colors disabled:opacity-50",children:r?"Updating...":"Update"}),t.jsx("button",{onClick:()=>{a(!1)},className:"text-white/80 hover:text-white transition-colors","aria-label":"Dismiss",children:t.jsx(i,{className:"w-5 h-5"})})]})]})}):null},b=o.memo(()=>t.jsx("div",{className:"flex items-center justify-center min-h-screen bg-gray-50",children:t.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[t.jsx("div",{className:"w-16 h-16 border-4 border-blue-200 border-t-blue-600 rounded-full animate-spin"}),t.jsx("p",{className:"text-gray-600 text-sm font-medium",children:"Loading..."})]})})),y=e.lazy(()=>p(()=>import("./Layout-intDW-7O.js"),__vite__mapDeps([0,1,2,3,4,5,6]))),N=e.lazy(()=>p(()=>import("./Dashboard-_4ngm2m9.js"),__vite__mapDeps([7,1,2,3,8,9,4,5,10]))),E=e.lazy(()=>p(()=>import("./QueueManager-heHsPXC9.js"),__vite__mapDeps([11,1,2,3,8,9,4,5,6,10,12]))),_=e.lazy(()=>p(()=>import("./ConfigEditor-9f1t8Dbo.js"),__vite__mapDeps([13,2,1,3]))),k=e.lazy(()=>p(()=>import("./AdvancedAnalytics-C1R4HXlQ.js"),__vite__mapDeps([14,1,2,3,8,9,4,5,10,12]))),L=e.lazy(()=>p(()=>import("./HealthCheck-DzBHATjD.js"),__vite__mapDeps([15,1,2,3]))),R=e.lazy(()=>p(()=>import("./LoginPage-CRmo6RvY.js"),__vite__mapDeps([16,1,2,3,4,5]))),S=e.lazy(()=>p(()=>import("./ProtectedRoute-Dc5APFTv.js"),__vite__mapDeps([17,1,2,3,4,5]))),I=e.lazy(()=>p(()=>import("./SecurityPage-B8Sfr7l_.js"),__vite__mapDeps([18,1,2,3,12]))),D=new g({defaultOptions:{queries:{retry:3,retryDelay:e=>Math.min(1e3*2**e,3e4),staleTime:5e3,gcTime:3e5,refetchOnWindowFocus:!1}}});function P(){return t.jsx(f,{children:t.jsx(d,{client:D,children:t.jsxs(c,{children:[t.jsx(w,{}),t.jsx(j,{}),t.jsx(v,{}),t.jsx(e.Suspense,{fallback:t.jsx(b,{}),children:t.jsxs(m,{children:[t.jsx(x,{path:"/login",element:t.jsx(R,{})}),t.jsxs(x,{path:"/",element:t.jsx(S,{children:t.jsx(y,{})}),children:[t.jsx(x,{index:!0,element:t.jsx(N,{})}),t.jsx(x,{path:"queue",element:t.jsx(E,{})}),t.jsx(x,{path:"config",element:t.jsx(_,{})}),t.jsx(x,{path:"security",element:t.jsx(I,{})}),t.jsx(x,{path:"analytics",element:t.jsx(k,{})}),t.jsx(x,{path:"health",element:t.jsx(L,{})}),t.jsx(x,{path:"*",element:t.jsx(h,{to:"/",replace:!0})})]})]})})]})})})}let A=null;(function(e={}){const{immediate:t=!1,onNeedRefresh:s,onOfflineReady:a,onRegistered:r,onRegisteredSW:n,onRegisterError:i}=e;let l,o,d;o=async function(){if("serviceWorker"in navigator){if(l=await p(async()=>{const{Workbox:e}=await import("./vendor-DC1Pnyyi.js").then(e=>e.w);return{Workbox:e}},__vite__mapDeps([2,1,3])).then(({Workbox:e})=>new e("/sw.js",{scope:"/",type:"classic"})).catch(e=>{i?.(e)}),!l)return;d=()=>{l?.messageSkipWaiting()};{let e=!1;const t=()=>{e=!0,l?.addEventListener("controlling",e=>{e.isUpdate&&window.location.reload()}),s?.()};l.addEventListener("installed",s=>{void 0===s.isUpdate?void 0!==s.isExternal&&s.isExternal?t():!e&&a?.():s.isUpdate||a?.()}),l.addEventListener("waiting",t)}l.register({immediate:t}).then(e=>{n?n("/sw.js",e):r?.(e)}).catch(e=>{i?.(e)})}}()})({immediate:!0,onNeedRefresh(){const e=new CustomEvent("pwa-update-available");window.dispatchEvent(e),A&&A()},onOfflineReady(){const e=new CustomEvent("pwa-offline-ready");window.dispatchEvent(e)},onRegistered(e){e&&setInterval(()=>{e.update()},36e5)},onRegisterError(e){}}),u(document.getElementById("root")).render(t.jsx(e.StrictMode,{children:t.jsx(P,{})}));
